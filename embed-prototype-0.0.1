window.digitalgoodsprovider=function(sdk){
	var tab,auth;
	var user=window.location.href.indexOf('?ext=')[1]||'na'+(+new Date());
	console.log(user);
	var btn
	='<div id="box-" style="position: relative;background: #B1D0E0;padding: 3px 6px 3px 6px;width: 285px;height:134px;display:inline-block;font-family:arial;color: #00A4F3;font-size:12px;border: 2px solid #00A4F3;border-radius: 3px;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:-moz-none;-ms-user-select:none;user-select:none;display:none;">'
	+	'<img src="http://digitalgoodsprovider.com/favicon.png" style="width:29px;vertical-align:-10px;margin-right:2px;">'
	+	'<b style="text-shadow: 1px 1px rgba(255, 255, 255, 0.6);">digitalgoodsprovider.com</b>'
	+	'<div class="buy" style="background: #FFDF65;border-bottom: 1px solid #BFA12E;color: #6D5C00;padding: 3px 6px 3px 6px;display: inline-block;width: 200px;margin-top: 4px;cursor: pointer;">'
	+		'$10 for 10,000 views '
	+		'<i style="float: right;font-weight:bold;color: rgba(84,67,0,0.81);text-shadow: 1px 4px 6px #FFDF65, 0 0 0 #000, 1px 4px 6px #FFDF65,1px 1px rgba(255, 255, 255, 0.6);">'
	+			'Buy Now »'
	+		'</i>'
	+	'</div>'
	+	'<input type="text" style="color: #000;padding: 3px 6px 3px 6px;border: none;margin-top: 1px;border-top: 12px solid #B1D0E0;display: table-cell;width: 200px;outline:none;" placeholder="Youtube Video Address Bar URL">'
	+	'<input type="text" style="color: #000;padding: 3px 6px 3px 6px;border: none;border-top: 1px solid #C7D5DC;display: table-cell;width: 200px;outline:none;" placeholder="Write Your  Pdf Cluser ID Here">'
	+	'<div style="background: #00A4F3;border-bottom: 1px solid #007CB7;color: rgba(0, 98, 146, 0.7);text-shadow: 1px 4px 6px #00A4F3, 0 0 0 #000, 1px 4px 6px #00A4F3,1px 1px rgba(255, 255, 255, 0.6);padding: 3px 6px 3px 6px;display: table-cell;width: 200px;font-weight: bold;text-align: center;cursor: pointer;">'
	+		'Confirm Content'
	+		'<b style="float: right;font-size: 11px;margin: 2px 0px -1px 0px;display: inline-block;">✔</b>'
	+	'</div>'
	+	'<div style="position: absolute;bottom: 9px;right: 0px;width: 80px;height: 97px;">'
	+		'<img src="http://digitalgoodsprovider.com/favicon.png" style="position: absolute;width: 22px;left: 53px;top: 2px;">'
	+		'<div style="position: absolute;width: 35px;left: 3px;top: 9px;height: 0px;border-image: url('+"'"+'http://digitalgoodsprovider.com/R/dashed.png'+"'"+') 3 round;">'
	+			'<div style="width: 0px;position: absolute;right: -9px;top: -7px;height: 1px;border-top: 7px solid transparent;border-left: 12px solid #fff;border-bottom: 7px solid transparent;"></div>'
	+		'</div>'
	+		'<div style="position: absolute;height: 39px;left: 61px;top: 25px;border-image: url('+"'"+'http://digitalgoodsprovider.com/R/dashed.png'+"'"+') 3 round;">'
	+			'<div style="position: absolute;width: 51px;left: -54px;top: 35px;height: 0px;border-image: url('+"'"+'http://digitalgoodsprovider.com/R/dashed.png'+"'"+') 3 round;">'
	+				'<img src="http://digitalgoodsprovider.com/R/pdf.png" style="position: absolute;right: -8px;">'
	+				'<img src="http://digitalgoodsprovider.com/R/download.png" style="position: absolute;right: -8px;top: 15px;">'
	+				'<div style="width: 0px;position: absolute;left: -9px;top: -7px;height: 1px;border-top: 7px solid transparent;border-right: 12px solid #fff;border-bottom: 7px solid transparent;"></div>'
	+			'</div>'
	+		'</div>'
	+	'</div>'
	+'</div>';
	function cors(method,url,cb){
		var xhr=new XMLHttpRequest();
		if("withCredentials" in xhr){xhr.open(method,url,true);}
		else if(typeof XDomainRequest!="undefined"){xhr=new XDomainRequest();xhr.open(method,url);}
		else{xhr=false;cb(xhr);}
		if(xhr){
			xhr.onload=function(){cb(xhr);};
			xhr.onerror=function(){console.log('xhr error');};
			xhr.send();
			}}
	$('.digitalgoodsprovider').each(function(){
		var that=$(this)[0];
		var box=$(that).attr('class').split('-')[1];
		$(this).append(btn);
		function corscb(xhr){
			if(xhr.status==200){
				auth=xhr.response;
				console.log(xhr);
				$(that).find('.buy').unbind('click').bind('click',function(){
					cors('POST','http://digitalgoodsprovider.com:8004?key='+sdk.key+'&box='+box+'&ext='+user,corscb);
					tab=window.open('http://digitalgoodsprovider.com?auth='+auth,'_blank');
					tab.focus();
					});}}
		cors('POST','http://digitalgoodsprovider.com:8004?key='+sdk.key+'&box='+box+'&ext='+user,corscb);
		});};
